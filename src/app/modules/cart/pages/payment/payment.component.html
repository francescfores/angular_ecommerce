<div *ngIf="success" class="relative z-10" aria-labelledby="modal-title" role="dialog" aria-modal="true">
  <div class="fixed inset-0 bg-gray-500 bg-opacity-75 transition-opacity"></div>
  <div class="fixed inset-0 z-10 overflow-y-auto">
    <div class="flex min-h-full items-center justify-center p-4 text-center sm:items-center sm:p-0">
      <div class="w-1/2 relative transform overflow-hidden rounded-lg bg-white text-left shadow-xl transition-all sm:my-8 sm:w-full sm:max-w-lg">
        <div class="p-5 flex justify-between">
          <h3 class="text-lg font-medium leading-6 text-gray-900">Crear atributo</h3>
          <button (click)="goToShop()">
            <svg class="h-8 w-8 text-gray-500"  width="10" height="10" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
              <path stroke="none" d="M0 0h24v24H0z"/>  <line x1="18" y1="6" x2="6" y2="18" />  <line x1="6" y1="6" x2="18" y2="18" />
            </svg>
          </button>
        </div>
        <div class="p-4 flex justify-between items-center space-x-2">
          <button  (click)="goToShop()" class="self-end inline-flex justify-center rounded-full text-gray-700
           border border-gray-300 bg-white
           py-2 px-4 text-sm
          font-medium  shadow-sm
          hover:bg-gray-50 ">
            Cerrar</button>

          <button (click)="goToShop()" class="self-end inline-flex justify-center rounded-full
          border border-transparent
          bg-orange-600 py-2 px-4 text-sm
          font-medium text-white shadow-sm
          hover:bg-orange-700 ">
            Continuar</button>
        </div>
      </div>
    </div>
  </div>
</div>
<div
     [ngClass]="{'hidden':!loading}"
     class='flex items-center justify-center h-96'>
  <div style="border-top-color:transparent" class="w-8 h-8 border-4 border-blue-200 rounded-full animate-spin"></div>
  <p class="ml-2"></p>
</div>
<div
  [ngClass]="{'hidden':loading}"
>
  <div
    [ngClass]="{'hidden':step !==4}"
    class="animate__animated animate__fadeIn animate__fadeIn--slow block p-10 container lg:w-2/3 xl:w-2/3 mx-auto">
    <h1 class="text-3xl font-bold mb-6">Payment method</h1>
    <div x-data="" class="bg-white p-4 rounded-lg shadow">
      <form novalidate [formGroup]="stripeTest" id="payment_metod">
        <div class="flex flex-col space-y-6">
          <label for="inputName" class="block text-sm font-medium text-gray-700">Name</label>
          <input id="inputName" [ngClass]="{ 'is-invalid': submitted && fc.name.errors }" formControlName="name" type="text" name="first-name"
                 class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm"
                 placeholder="Name and surname" >
          <div *ngIf="submitted && fc.name.errors" class="invalid-feedback">
            <div *ngIf="fc.name.errors.required">name is required</div>
          </div>
          <ngx-stripe-card [options]="cardOptions" [elementsOptions]="elementsOptions" id="stripe_card">
          </ngx-stripe-card>
          <div id="card-element">

          </div>
          <button id="comfirm_payment" (click)="createToken()"   type="submit" class="
        text-white bg-text-primary
        hover:border-2 hover:border-primary
        hover:text-primary hover:bg-transparent
        rounded-md w-full py-3 text-lg">
            Continue
          </button>
        </div>

      </form>
    </div>
  </div>
  <div
    [ngClass]="{'hidden':step !==5}"
    class="flex flex-wrap justify-between ">
    <div
      class="animate__animated animate__fadeIn animate__fadeIn--slow p-10 w-auto mx-auto grid grid-cols-12 gap-6">
      <h1 class="text-3xl font-bold col-span-12">Summary</h1>
      <div x-data="" class="bg-white p-4 rounded-lg shadow col-span-8">
        <div>
          <div *ngFor="let product of this.groupedProducts;" class="w-full flex flex-col sm:flex-row items-center gap-4 py-2">
            <a href="/src/product.html" class="w-36 h-32 flex items-center justify-center overflow-hidden">
              <img class="object-cover" alt="" src="http://ctrl-api.test/storage/images/{{product.img}}">
            </a>
            <div class="flex-1 flex flex-col justify-between">
              <div class="flex justify-between mb-3">
                <h3 >{{product.product.name}}</h3>

              </div>
              <div class="flex justify-between items-center">
                <p>{{product.price/100 | number:'1.2-2'}}€</p>
                <div class="flex items-center">
                  <p>Qty:&#160;{{product.count}}</p>

                </div>
                <span class="text-lg font-semibold">
                          <span>{{product.total/100 | number:'1.2-2'}}€</span>
                        </span>
              </div>
            </div>
          </div>
        </div>

      </div>
      <div x-data="" class="h-min bg-white p-4 rounded-lg shadow col-span-4 gap-6">
        <div class="flex justify-start py-4 ">
          <h1 class="mr-16 text-md font-bold">Summary</h1>
        </div>
        <div class="flex justify-between py-4 ">
          <p class="mr-16 text-sm">Subtotal items</p>
          <p class="text-sm font-bold" >{{cart.total/100 | number:'1.2-2'}}€</p>
        </div>
        <div class="flex justify-between py-4 ">
          <p class="mr-16 text-sm ">Estimated Shipping</p>
          <p class="text-sm font-bold" >{{cart.shipping.carrier.rate/100 | number:'1.2-2'}}€</p>
        </div>
        <!-- <div class="flex justify-between py-4 ">
          <p class="mr-16 text-sm">Abono de portes</p>
          <p class="text-sm font-bold text-green-400" >-5,00€</p>
        </div>-->
        <div class="border-t border-gray-300 pt-4"></div>
        <div class="flex justify-between py-4 ">
          <p class="mr-16 text-sm">Total (Tax included)</p>
          <p class="text-sm font-bold" >{{cart.sub_total/100 | number:'1.2-2'}}€</p>
        </div>
        <div class="pt-4">
          <!-- <button (click)="createOrder()" type="submit" class="-->
          <!-- <button *ngIf="!showPaypalButtons" (click)="pay()" type="submit" class="-->
          <button  id="step-1" (click)="paymentIntent()" type="submit" class="
        text-white bg-text-primary
        hover:border-2 hover:border-primary
        hover:text-primary hover:bg-transparent
        rounded-md w-full py-3 text-lg">
            Continue
          </button>
        </div>
      </div>
    </div>
  </div>
</div>

