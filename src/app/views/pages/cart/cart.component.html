<div class="w-full py-6">
  <div class="flex">
    <div (click)="goStep(1)" class="w-1/5">
      <div class="relative mb-2">
        <div
        class="w-10 h-10 mx-auto bg-secondary border-2 border-gray-200 rounded-full text-lg text-white flex items-center">
          <span class="text-center text-white w-full">
            <svg class="w-full fill-current" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" width="24" height="24">
              <path class="heroicon-ui" d="M5 3h14a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5c0-1.1.9-2 2-2zm14 8V5H5v6h14zm0 2H5v6h14v-6zM8 9a1 1 0 1 1 0-2 1 1 0 0 1 0 2zm0 8a1 1 0 1 1 0-2 1 1 0 0 1 0 2z"/>
            </svg>
          </span>
        </div>
      </div>

      <div class="text-xs text-center md:text-base">Carrito</div>
    </div>

    <div (click)="goStep(2)" class="w-1/5">
      <div class="relative mb-2">
        <div
          class="absolute flex align-center items-center align-middle content-center" style="width: calc(100% - 2.5rem - 1rem); top: 50%; transform: translate(-50%, -50%)">
          <div
            [ngClass]="{
          'bg-primary': step >= 2 && step <= 5,
          'bg-gray-200': step ===1}" class="w-full  rounded items-center align-middle align-center flex-1">
            <div class="w-0  py-1 rounded" style="width: 100%;"></div>
          </div>
        </div>

        <div
          [ngClass]="{
          'bg-secondary text-white': step >= 2 && step <= 5,
          'bg-white text-gray-600': step ===1}"
          class="w-10 h-10 mx-auto border-2 border-gray-200  rounded-full text-lg text-white flex items-center">
          <span class="text-center  w-full">
            <svg class="w-full fill-current" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" width="24" height="24">
              <path class="heroicon-ui" d="M19 10h2a1 1 0 0 1 0 2h-2v2a1 1 0 0 1-2 0v-2h-2a1 1 0 0 1 0-2h2V8a1 1 0 0 1 2 0v2zM9 12A5 5 0 1 1 9 2a5 5 0 0 1 0 10zm0-2a3 3 0 1 0 0-6 3 3 0 0 0 0 6zm8 11a1 1 0 0 1-2 0v-2a3 3 0 0 0-3-3H7a3 3 0 0 0-3 3v2a1 1 0 0 1-2 0v-2a5 5 0 0 1 5-5h5a5 5 0 0 1 5 5v2z"/>
            </svg>
          </span>
        </div>
      </div>

      <div class="text-xs text-center md:text-base">Dirección de envío</div>
    </div>

    <div (click)="goStep(3)" class="w-1/5">
      <div class="relative mb-2">
        <div class="absolute flex align-center items-center align-middle content-center" style="width: calc(100% - 2.5rem - 1rem); top: 50%; transform: translate(-50%, -50%)">
          <div
            class="w-full bg-gray-200 rounded items-center align-middle align-center flex-1">
            <div
              [ngClass]="{
              'bg-primary': step >= 3 && step <= 5,
              'bg-gray-200': step ===2}"
              class="w-0  py-1 rounded" style="width: 100%;"></div>
          </div>
        </div>

        <div
          [ngClass]="{
          'bg-secondary text-white': step >= 3 && step <= 5,
          'bg-white text-gray-600': step ===2}"
          class="w-10 h-10 mx-auto border-2 border-gray-200 rounded-full text-lg text-white flex items-center">
          <span class="text-center w-full">
            <svg class="w-full fill-current" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" width="24" height="24">
              <path class="heroicon-ui" d="M9 4.58V4c0-1.1.9-2 2-2h2a2 2 0 0 1 2 2v.58a8 8 0 0 1 1.92 1.11l.5-.29a2 2 0 0 1 2.74.73l1 1.74a2 2 0 0 1-.73 2.73l-.5.29a8.06 8.06 0 0 1 0 2.22l.5.3a2 2 0 0 1 .73 2.72l-1 1.74a2 2 0 0 1-2.73.73l-.5-.3A8 8 0 0 1 15 19.43V20a2 2 0 0 1-2 2h-2a2 2 0 0 1-2-2v-.58a8 8 0 0 1-1.92-1.11l-.5.29a2 2 0 0 1-2.74-.73l-1-1.74a2 2 0 0 1 .73-2.73l.5-.29a8.06 8.06 0 0 1 0-2.22l-.5-.3a2 2 0 0 1-.73-2.72l1-1.74a2 2 0 0 1 2.73-.73l.5.3A8 8 0 0 1 9 4.57zM7.88 7.64l-.54.51-1.77-1.02-1 1.74 1.76 1.01-.17.73a6.02 6.02 0 0 0 0 2.78l.17.73-1.76 1.01 1 1.74 1.77-1.02.54.51a6 6 0 0 0 2.4 1.4l.72.2V20h2v-2.04l.71-.2a6 6 0 0 0 2.41-1.4l.54-.51 1.77 1.02 1-1.74-1.76-1.01.17-.73a6.02 6.02 0 0 0 0-2.78l-.17-.73 1.76-1.01-1-1.74-1.77 1.02-.54-.51a6 6 0 0 0-2.4-1.4l-.72-.2V4h-2v2.04l-.71.2a6 6 0 0 0-2.41 1.4zM12 16a4 4 0 1 1 0-8 4 4 0 0 1 0 8zm0-2a2 2 0 1 0 0-4 2 2 0 0 0 0 4z"/>
            </svg>
          </span>
        </div>
      </div>

      <div class="text-xs text-center md:text-base">
        Opciones de entrega</div>
    </div>

    <div (click)="goStep(4)" class="w-1/5">
      <div class="relative mb-2">
        <div class="absolute flex align-center items-center align-middle content-center" style="width: calc(100% - 2.5rem - 1rem); top: 50%; transform: translate(-50%, -50%)">
          <div class="w-full bg-gray-200 rounded items-center align-middle align-center flex-1">
            <div
              [ngClass]="{
              'bg-primary': step >= 4 && step <= 5,
              'bg-gray-200': step ===3}"
              class="w-0 py-1 rounded" style="width: 100%;"></div>
          </div>
        </div>

        <div
          [ngClass]="{
          'bg-secondary text-white': step >= 4 && step <= 5,
          'bg-white text-gray-600': step ===3}"
          class="w-10 h-10 mx-auto border-2 border-gray-200 rounded-full text-lg text-white flex items-center">
          <span class="text-center w-full">
            <svg class="w-full fill-current" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" width="24" height="24">
              <path class="heroicon-ui" d="M12 22a10 10 0 1 1 0-20 10 10 0 0 1 0 20zm0-2a8 8 0 1 0 0-16 8 8 0 0 0 0 16zm-2.3-8.7l1.3 1.29 3.3-3.3a1 1 0 0 1 1.4 1.42l-4 4a1 1 0 0 1-1.4 0l-2-2a1 1 0 0 1 1.4-1.42z"/>
            </svg>
          </span>
        </div>
      </div>

      <div class="text-xs text-center md:text-base">Método de pago</div>
    </div>
    <div (click)="goStep(5)" class="w-1/5">
      <div class="relative mb-2">
        <div class="absolute flex align-center items-center align-middle content-center" style="width: calc(100% - 2.5rem - 1rem); top: 50%; transform: translate(-50%, -50%)">
          <div
            class="w-full bg-gray-200 rounded items-center align-middle align-center flex-1">
            <div
            [ngClass]="{
            'bg-primary': step >= 5 && step <= 5}"
            class="w-0 py-1 rounded" style="width: 100%;"></div>
          </div>
        </div>
        <div
          [ngClass]="{
          'bg-secondary text-white': step >= 5 && step <= 5,
          'bg-white text-gray-600': step ===4}"
          class="w-10 h-10 mx-auto  border-2 border-gray-200 rounded-full text-lg text-white flex items-center">
          <span class="text-center  w-full">
            <svg class="w-full fill-current" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" width="24" height="24">
              <path class="heroicon-ui" d="M12 22a10 10 0 1 1 0-20 10 10 0 0 1 0 20zm0-2a8 8 0 1 0 0-16 8 8 0 0 0 0 16zm-2.3-8.7l1.3 1.29 3.3-3.3a1 1 0 0 1 1.4 1.42l-4 4a1 1 0 0 1-1.4 0l-2-2a1 1 0 0 1 1.4-1.42z"/>
            </svg>
          </span>
        </div>
      </div>
      <div class="text-xs text-center md:text-base">Resumen</div>
    </div>

  </div>
</div>

<section *ngIf="step === 1">
  <div
    [ngClass]="{'animate__animated animate__fadeIn animate__fadeIn--slow': step === 1}"
    class="p-10 container lg:w-2/3 xl:w-2/3 mx-auto">
    <h1 class="text-3xl font-bold mb-6">Artículos de su carrito</h1>
    <div x-data="" class="bg-white p-4 rounded-lg shadow">
      <!-- Product Items -->
      <div>
        <!-- Product Item -->
        <div *ngFor="let product of this.cart.products;" class="w-full flex flex-col sm:flex-row items-center gap-4">
          <a href="/src/product.html" class="w-36 h-32 flex items-center justify-center overflow-hidden">
            <img class="object-cover" alt="" src="{{product.img}}">
          </a>
          <div class="flex-1 flex flex-col justify-between">
            <div class="flex justify-between mb-3">
              <h3 x-text="product.title">{{product.name}}</h3>
              <span class="text-lg font-semibold">
                          $<span x-text="product.price">{{product.total}}</span>
                        </span>
            </div>
            <div class="flex justify-between items-center">
              <div class="flex items-center">
                Qty:
                <input min="1" (change)="updateCount($event, product)" value="{{product.count}}" type="number" class="ml-3 py-1 border-gray-200 focus:border-purple-600 focus:ring-purple-600 w-16">
              </div>
              <a  (click)="removeProduct(product)" class="text-purple-600 hover:text-purple-500">Remove</a>
            </div>
          </div>
        </div>
        <!--/ Product Item -->

        <!-- Product Item -->
      </div>
      <!--/ Product Items -->
      <div class="border-t border-gray-300 pt-4">
        <div class="flex justify-between">
          <span class="font-semibold">Subtotal</span>
          <span class="text-xl" x-text="`$${total}`">${{totalPrice}}</span>
        </div>
        <p class="text-gray-500 mb-6">
          Envío e impuestos calculados al finalizar la compra.
        </p>

        <button (click)="goStep(2)" type="submit" class="
        text-white bg-text-primary
        hover:border-2 hover:border-primary
        hover:text-primary hover:bg-transparent
        rounded-md w-full py-3 text-lg">
          Continuar
        </button>
      </div>
    </div>
  </div>
</section>
<section *ngIf="step === 2">
  <div
    [ngClass]="{'animate__animated animate__fadeIn animate__fadeIn--slow': step === 2}"
    class="p-10 container lg:w-2/3 xl:w-2/3 mx-auto">
    <h1 class="text-3xl font-bold mb-6">Datos personales</h1>
    <div x-data="" class="bg-white p-4 rounded-lg shadow">
      <!-- Product Items -->
      <div>
        <!-- Product Item -->
        <div class="my-auto ml-5 h-full flex-col space-y-12 text-left text-neutral-700">
          <form action=""></form>
          <div class="flex flex-col space-y-4">
            <div class="flex flex-row space-x-2">
              <div class="w-1/2">
                <label class="mb-2 block text-sm font-bold" for="username"> Nombre </label>
                <input class="text-w focus:shadow-outline w-full appearance-none rounded border bg-transparent py-2 px-3 leading-tight shadow focus:border-orange-400 focus:outline-none" id="username" type="text" placeholder="Username" />
              </div>
              <div class="w-1/2">
                <label class="mb-2 block text-sm font-bold" for="username"> Apellidos </label>
                <input class="text-w focus:shadow-outline w-full appearance-none rounded border bg-transparent py-2 px-3 leading-tight shadow focus:border-orange-400 focus:outline-none" id="username" type="text" placeholder="Username" />
              </div>
            </div>
            <div class="flex flex-row space-x-2">
              <div class="w-1/2">
                <label class="mb-2 block text-sm font-bold" for="username"> DNI/CIF/NIF </label>
                <input class="text-w focus:shadow-outline w-full appearance-none rounded border bg-transparent py-2 px-3 leading-tight shadow focus:border-orange-400 focus:outline-none" id="username" type="text" placeholder="Username" />
              </div>
              <div class="w-1/2">
                <label class="mb-2 block text-sm font-bold" for="username"> Móvil </label>
                <input class="text-w focus:shadow-outline w-full appearance-none rounded border bg-transparent py-2 px-3 leading-tight shadow focus:border-orange-400 focus:outline-none" id="username" type="text" placeholder="Username" />
              </div>
            </div>
            <div class="">
              <label class="mb-2 block text-sm font-bold" for="username"> Dirección de envío
              </label>
              <input class="text-w focus:shadow-outline w-full appearance-none rounded border bg-transparent py-2 px-3 leading-tight shadow focus:border-orange-400 focus:outline-none" id="username" type="text" placeholder="Dirección" />
              <input class="mt-4 text-w focus:shadow-outline w-full appearance-none rounded border bg-transparent py-2 px-3 leading-tight shadow focus:border-orange-400 focus:outline-none" id="username" type="text" placeholder="Piso, escalera, puerta, etc. (opcional)" />
              <input class="mt-4 text-w focus:shadow-outline w-full appearance-none rounded border bg-transparent py-2 px-3 leading-tight shadow focus:border-orange-400 focus:outline-none" id="username" type="text" placeholder="Escribe aquí tus observaciones para la agencia..." />
            </div>
            <div class="flex flex-row space-x-2">
              <div class="w-1/2">
                <label class="mb-2 block text-sm font-bold" for="username"> País </label>
                <input class="text-w focus:shadow-outline w-full appearance-none rounded border bg-transparent py-2 px-3 leading-tight shadow focus:border-orange-400 focus:outline-none" id="username" type="text" placeholder="País" />
              </div>
              <div class="w-1/2">
                <label class="mb-2 block text-sm font-bold" for="username"> Código postal </label>
                <input class="text-w focus:shadow-outline w-full appearance-none rounded border bg-transparent py-2 px-3 leading-tight shadow focus:border-orange-400 focus:outline-none" id="username" type="text" placeholder="Código postal" />
              </div>
            </div>
            <div class="flex flex-row space-x-2">
              <div class="w-1/2">
                <label class="mb-2 block text-sm font-bold" for="username"> Población </label>
                <input class="text-w focus:shadow-outline w-full appearance-none rounded border bg-transparent py-2 px-3 leading-tight shadow focus:border-orange-400 focus:outline-none" id="username" type="text" placeholder="Población" />
              </div>
              <div class="w-1/2">
                <label class="mb-2 block text-sm font-bold" for="username"> Provincia </label>
                <input class="text-w focus:shadow-outline w-full appearance-none rounded border bg-transparent py-2 px-3 leading-tight shadow focus:border-orange-400 focus:outline-none" id="username" type="text" placeholder="Provincia" />
              </div>
            </div>
          </div>
        </div>
        <!--/ Product Item -->

        <!-- Product Item -->
      </div>
      <!--/ Product Items -->
      <div class="border-t border-gray-300 pt-4">
        <button (click)="goStep(3)" type="submit" class="
        text-white bg-text-primary
        hover:border-2 hover:border-primary
        hover:text-primary hover:bg-transparent
        rounded-md w-full py-3 text-lg">
          Continuar
        </button>
      </div>
    </div>
  </div>
</section>
<section *ngIf="step === 3">
  <div
    [ngClass]="{'animate__animated animate__fadeIn animate__fadeIn--slow': step === 3}"
    class="p-10 container lg:w-2/3 xl:w-2/3 mx-auto">
    <h1 class="text-3xl font-bold mb-6">Opciones de entrega</h1>
    <div x-data="" class="bg-white p-4 rounded-lg shadow">
      <!-- Product Items -->
      <div>
        <!-- Product Item -->
        <div *ngFor="let product of this.cart.products;" class="w-full flex flex-col sm:flex-row items-center gap-4">
          <a href="/src/product.html" class="w-36 h-32 flex items-center justify-center overflow-hidden">
            <img class="object-cover" alt="" src="{{product.img}}">
          </a>
          <div class="flex-1 flex flex-col justify-between">
            <div class="flex justify-between mb-3">
              <h3 x-text="product.title">{{product.name}}</h3>
              <span class="text-lg font-semibold">
                          $<span x-text="product.price">{{product.price}}</span>
                        </span>
            </div>
            <div class="flex justify-between items-center">
              <div class="flex items-center">
                Qty:
                <input type="number" x-model="product.quantity" class="ml-3 py-1 border-gray-200 focus:border-purple-600 focus:ring-purple-600 w-16">
              </div>
              <a href="#" class="text-purple-600 hover:text-purple-500">Remove</a>
            </div>
          </div>
        </div>
        <!--/ Product Item -->

        <!-- Product Item -->
      </div>
      <!--/ Product Items -->
      <div class="border-t border-gray-300 pt-4">
        <button (click)="goStep(4)" type="submit" class="
        text-white bg-text-primary
        hover:border-2 hover:border-primary
        hover:text-primary hover:bg-transparent
        rounded-md w-full py-3 text-lg">
          Continuar
        </button>
      </div>
    </div>
  </div>
</section>
<section *ngIf="step === 4">
  <div
    [ngClass]="{'animate__animated animate__fadeIn animate__fadeIn--slow': step === 4}"
    class="p-10 container lg:w-2/3 xl:w-2/3 mx-auto">
    <h1 class="text-3xl font-bold mb-6">Método de pago</h1>
    <div x-data="" class="bg-white p-4 rounded-lg shadow">
      <!-- Product Items -->
      <div>
        <!-- Product Item -->
        <div *ngFor="let product of this.cart.products;" class="w-full flex flex-col sm:flex-row items-center gap-4">
          <a href="/src/product.html" class="w-36 h-32 flex items-center justify-center overflow-hidden">
            <img class="object-cover" alt="" src="{{product.img}}">
          </a>
          <div class="flex-1 flex flex-col justify-between">
            <div class="flex justify-between mb-3">
              <h3 x-text="product.title">{{product.name}}</h3>
              <span class="text-lg font-semibold">
                          $<span x-text="product.price">{{product.price}}</span>
                        </span>
            </div>
            <div class="flex justify-between items-center">
              <div class="flex items-center">
                Qty:
                <input type="number" x-model="product.quantity" class="ml-3 py-1 border-gray-200 focus:border-purple-600 focus:ring-purple-600 w-16">
              </div>
              <a href="#" class="text-purple-600 hover:text-purple-500">Remove</a>
            </div>
          </div>
        </div>
        <!--/ Product Item -->

        <!-- Product Item -->
      </div>
      <!--/ Product Items -->
      <div class="border-t border-gray-300 pt-4">
        <button (click)="goStep(5)" type="submit" class="
        text-white bg-text-primary
        hover:border-2 hover:border-primary
        hover:text-primary hover:bg-transparent
        rounded-md w-full py-3 text-lg">
          Continuar
        </button>
      </div>
    </div>
  </div>
</section>
<section *ngIf="step === 5 && !showPaypalButtons">
  <div *ngIf=" loading" class='flex items-center justify-center h-96'>
    <div style="border-top-color:transparent" class="w-8 h-8 border-4 border-blue-200 rounded-full animate-spin"></div>
    <p class="ml-2"></p>
  </div>
  <div *ngIf=" !loading"
    [ngClass]="{'animate__animated animate__fadeIn animate__fadeIn--slow': step === 5}"
    class="p-10 container lg:w-2/3 xl:w-2/3 mx-auto">
    <h1 class="text-3xl font-bold mb-6">Resumen</h1>
    <div x-data="" class="bg-white p-4 rounded-lg shadow">
      <!-- Product Items -->
      <div>
        <!-- Product Item -->
        <div *ngFor="let product of this.groupedProducts;" class="w-full flex flex-col sm:flex-row items-center gap-4">
          <a href="/src/product.html" class="w-36 h-32 flex items-center justify-center overflow-hidden">
            <img class="object-cover" alt="" src="{{product.img}}">
          </a>
          <div class="flex-1 flex flex-col justify-between">
            <div class="flex justify-between mb-3">
              <h3 x-text="product.title">{{product.name}}</h3>
              <span class="text-lg font-semibold">
                          $<span x-text="product.price">{{product.price}}</span>
                        </span>
            </div>
            <div class="flex justify-between items-center">
              <div class="flex items-center">
                Qty:
                <input type="number" x-model="product.quantity" class="ml-3 py-1 border-gray-200 focus:border-purple-600 focus:ring-purple-600 w-16">
              </div>
              <a href="#" class="text-purple-600 hover:text-purple-500">Remove</a>
            </div>
          </div>
        </div>
        <!--/ Product Item -->
        <!-- Product Item -->
      </div>
      <!--/ Product Items -->
      <div class="border-t border-gray-300 pt-4">
       <!-- <button (click)="createOrder()" type="submit" class="-->
        <button *ngIf="!showPaypalButtons" (click)="pay()" type="submit" class="
        text-white bg-text-primary
        hover:border-2 hover:border-primary
        hover:text-primary hover:bg-transparent
        rounded-md w-full py-3 text-lg">
          Pagar
        </button>
      </div>
    </div>
  </div>
</section>
<section *ngIf="step === 5 && showPaypalButtons">
  <div *ngIf=" loading" class='flex items-center justify-center h-96'>
    <div style="border-top-color:transparent" class="w-8 h-8 border-4 border-blue-200 rounded-full animate-spin"></div>
    <p class="ml-2"></p>
  </div>
  <div *ngIf=" !loading"
       [ngClass]="{'animate__animated animate__fadeIn animate__fadeIn--slow': step === 5}"
       class="p-10 container lg:w-2/3 xl:w-2/3 mx-auto">
    <ngx-paypal
      *ngIf="showPaypalButtons" [config]="payPalConfig">
    </ngx-paypal>
    <button *ngIf="showPaypalButtons" (click)="back()">Volver atras</button>
  </div>
</section>

